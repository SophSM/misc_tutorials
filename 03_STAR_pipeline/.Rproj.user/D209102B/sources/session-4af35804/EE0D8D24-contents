---
title: "Get list of genes to predict"
author: "Sofia Salazar"
date: "2023-10-23"
description: "Query a list of genes to predict with enformer/borzoi"
categories: [formatting]
format:
  html:
    code-fold: false
    code-summary: "Show the code"
    code-tools: true
    code-overflow: wrap
editor_options: 
  chunk_output_type: console
---

```{r}
library(data.table)
```

## Large enformer correlations df

```{r}
corrs_df <- read.csv('/Users/sofiasalazar/Desktop/LAB/IM-lab/corrs_df.csv')
genes_ordered <- corrs_df[order(corrs_df$ge_abs, decreasing = T), 3]
```

## Read geuvadis data to get genes that are recorded in this dataset

```{r}
geuvadis_df <- fread('cat /Users/sofiasalazar/Desktop/LAB/IM-lab/geuvadis_expression.gz | gunzip')
geuvadis_genes <- geuvadis_df$gene_name
```

## Save genes to predict list

```{r}
genes_to_predict <- genes_ordered[genes_ordered %in% geuvadis_genes]
write.csv(genes_to_predict, file = '/Users/sofiasalazar/Desktop/LAB/IM-lab/genes_to_predict.csv')
```

## Save 7 separate lists of genes with worst enformer performance

```{r}
worst <- tail(genes_to_predict, 140)
```

```{r}
past <- 0
for (i in 1:7){
  list <- worst[(past + 1): (i* 20)]
  write.csv(list, file = paste0('/Users/sofiasalazar/Desktop/LAB/IM-lab/worst_list', i, '.csv'))
  past <- (i* 20)
}
```


